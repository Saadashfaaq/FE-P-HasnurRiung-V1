<div *ngIf="isWaitingForResponse" class="inner-loading-indicator">
  <mat-spinner color="primary" [diameter]="100"></mat-spinner>
</div>
<div [ngClass]="{'hidden': isWaitingForResponse}" class="px-8 pt-4 pb-2">
  <div class="flex flex-row items-start justify-between">
    <div>
      <h2 class="text-gray-900">Timeline</h2>
    </div>
    <div>
      <button (click)="openSwalCancel()" mat-icon-button>
        <mat-icon>close</mat-icon>
      </button>
    </div>
  </div>
  <mat-divider></mat-divider>
  <div
    class="flex flex-row gap-4 mb-2 w-full"
  >

  <div class="mt-6 w-full">
    <mat-stepper #stepper [orientation]="isShowMobile ? 'vertical' : 'horizontal'">
      <div  *ngFor="let approval of approvalData; let i = index">
        <mat-step [completed]="false" [editable]="approval.approval_status === 'cancelled'? false : true" [state]="approval.approval_status" [label]="'Approval ' + (i + 1)">
          <!-- For Approved Step -->
          <div *ngIf="approval?.approval_status === 'approved'">
            <div class="w-full md:max-w-2xl">
              <div class="flex flex-row align-center ">
                <div class="mr-3">
                  <h3 class="text-2xl font-bold">{{getStatusTooltip(approval.approval_status)}}</h3>
                </div>
                <div style="display: flex; align-items: center;">
                  <mat-icon style="color: #01BA6D;">lens</mat-icon>
                </div>
              </div>
              <div class="flex flex-row w-full">
                <div class="w-full lg:min-w-70">
                  <div class="uppercase tracking-wide">
                    <span>
                      {{formatDate(approval.date_of_approval)}}
                    </span>
                  </div>
                  <div class="block mt-1 text-lg leading-tight font-medium text-black">
                    <span>
                      {{formatTime(approval.date_of_approval)}}
                    </span>
                  </div>
                  <div class="mt-5 text-gray-500">
                    <div class="flex items-center mt-2">
                      <span class="text-lg">{{approval.approver_id.name}}</span>
                    </div>
                    <div class="flex items-center mt-2">
                      <span >{{approval.approver_id.position.department}}</span>
                    </div>
                    <div class="flex items-center mt-2">
                      <span >{{approval.approver_id.position.name}}</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
           <!-- For revision Step -->
          <div *ngIf="approval?.approval_status === 'revision'">
            <div class="max-w-sm md:max-w-2xl">
              <div class="flex flex-row align-center ">
                <div class="mr-3">
                  <h3 class="text-2xl font-bold">{{getStatusTooltip(approval.approval_status)}}</h3>
                </div>
                <div style="display: flex; align-items: center;">
                  <mat-icon style="color: #fffe00;">lens</mat-icon>
                </div>
              </div>
              <div class="flex flex-col lg:flex-row w-full">
                <div class="w-full lg:min-w-70">
                  <div class="uppercase tracking-wide font-semibold">
                    {{formatDate(approval.date_of_revision)}}
                  </div>
                  <div class="block mt-1 text-lg leading-tight font-medium text-black">
                    {{formatTime(approval.date_of_revision)}}
                  </div>
                  <div class="mt-5 text-gray-500">
                    <div class="flex items-center mt-2">
                      <span class="text-lg">{{approval.approver_id.name}}</span>
                    </div>
                    <div class="flex items-center mt-2">
                      <span >{{approval.approver_id.position.department}}</span>
                    </div>
                    <div class="flex items-center mt-2">
                      <span >{{approval.approver_id.position.name}}</span>
                    </div>
                  </div>
                </div>
                <mat-divider class="h-full" [vertical]="true"></mat-divider>
                <div class="lg:ml-4">
                  <span >
                    {{approval?.reason_of_revision}}
                  </span>
                </div>
              </div>
            </div>
          </div>
           <!-- For rejected Step -->
          <div *ngIf="approval?.approval_status === 'rejected'">
            <div class="max-w-sm md:max-w-2xl">
              <div class="flex flex-row align-center ">
                <div class="mr-3">
                  <h3 class="text-2xl font-bold">{{getStatusTooltip(approval.approval_status)}}</h3>
                </div>
                <div style="display: flex; align-items: center;">
                  <mat-icon style="color: #ff0100;">lens</mat-icon>
                </div>
              </div>
              <div class="flex flex-col lg:flex-row w-full">
                <div class="w-full lg:min-w-70">
                  <div class="uppercase tracking-wide font-semibold">
                    {{formatDate(approval.date_of_rejection)}}
                  </div>
                  <div class="block mt-1 text-lg leading-tight font-medium text-black">
                    {{formatTime(approval.date_of_rejection)}}
                  </div>
                  <div class="mt-5 text-gray-500">
                    <div class="flex items-center mt-2">
                      <span class="text-lg">{{approval.approver_id.name}}</span>
                    </div>
                    <div class="flex items-center mt-2">
                      <span >{{approval.approver_id.position.department}}</span>
                    </div>
                    <div class="flex items-center mt-2">
                      <span >{{approval.approver_id.position.name}}</span>
                    </div>
                  </div>
                </div>
                <mat-divider [vertical]="true"></mat-divider>
                <div class="lg:ml-4">
                  <span >
                    {{approval?.reason_of_rejection}}
                  </span>
                </div>
              </div>
            </div>
          </div>
           <!-- For waiting_for_approval Step -->
          <div *ngIf="approval?.approval_status === 'waiting_for_approval'">
            <div class="max-w-sm md:max-w-2xl">
              <div class="flex flex-row align-center ">
                <div class="mr-3">
                  <h3 class="text-2xl font-bold">{{getStatusTooltip(approval.approval_status)}}</h3>
                </div>
                <div style="display: flex; align-items: center;">
                  <mat-icon style="color: #ffa000;">lens</mat-icon>
                </div>
              </div>
              <div class="flex flex-row w-full">
                <div class="w-full lg:min-w-70">
                  <div class="mt-5 text-gray-500">
                    <div class="flex items-center mt-2">
                      <span class="text-lg ">{{approval.approver_id.name}}</span>
                    </div>
                    <div class="flex items-center mt-2">
                      <span >{{approval.approver_id.position.department}}</span>
                    </div>
                    <div class="flex items-center mt-2">
                      <span >{{approval.approver_id.position.name}}</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </mat-step>
      </div>
      <ng-template  matStepperIcon="waiting_for_approval">
        <div style="width: 48px; height: 48px;background-color: #ffa000; border-radius: 50%;">

        </div>
      </ng-template>
      <ng-template  matStepperIcon="rejected">
        <div style="display: flex; justify-content: center; align-items: center; width: 56px; height: 56px;background-color: #ff0100; border-radius: 50%;">
        </div>
      </ng-template>
      <ng-template matStepperIcon="approved">
        <div style="display: flex; justify-content: center; align-items: center; width: 56px; height: 56px; background-color: #01BA6D; border-radius: 50%;">
        </div>
      </ng-template>
      <ng-template  matStepperIcon="revision">
        <div style="display: flex; justify-content: center; align-items: center; width: 56px; height: 56px;background-color: #fffe00; border-radius: 50%;">
        </div>
      </ng-template>
      <ng-template matStepperIcon="edit">
        <div style="display: flex; justify-content: center; align-items: center; width: 56px; height: 56px; background-color: #015BAB; border-radius: 50%;">
          <mat-icon>done</mat-icon>
        </div>
      </ng-template>
      <ng-template matStepperIcon="cancelled">
        <div style="display: flex; justify-content: center; align-items: center; width: 56px; height: 56px;background-color: #D9D9D9; border-radius: 50%;">
        </div>
      </ng-template>
    </mat-stepper>
  </div>
  </div>
</div>
